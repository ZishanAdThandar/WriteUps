---
layout: default
---

<section class="list-page">
  <header class="list-header">
    <h1 class="list-title">{{ page.title }}</h1>
    {% if page.description %}
      <p class="list-desc">{{ page.description }}</p>
    {% endif %}
  </header>

  <div class="list-grid">
    {% comment %} Get current category from page URL {% endcomment %}
    {% assign current_path = page.url %}
    {% assign category_parts = current_path | split: '/' %}
    {% assign current_category = category_parts[2] %}
    
    {% comment %} Debug info (remove after testing) {% endcomment %}
    <!-- Current category: {{ current_category }} -->
    <!-- Page URL: {{ page.url }} -->
    <!-- Total site posts: {{ site.posts.size }} -->
    
    {% comment %} Filter posts by category path {% endcomment %}
    {% assign filtered_posts = site.posts | where_exp: "post", "post.path contains current_category" %}
    
    {% comment %} Debug filtered posts {% endcomment %}
    <!-- Filtered posts count: {{ filtered_posts.size }} -->
    <!-- Sample post paths: -->
    <!-- {% for post in filtered_posts limit:3 %}{{ post.path }}|{% endfor %} -->

    {% if filtered_posts.size > 0 %}
      {% assign sorted_items = filtered_posts | sort: "date" | reverse %}

      {% for post in sorted_items %}
        {% unless post.path contains 'imaginaryctf' or post.path contains 'index' %}
          <article class="list-item">
            <a href="{{ post.url | relative_url }}">
              <h2 class="list-item-title">
                {{ post.title | default: post.name }}
              </h2>
              
              {% if post.description %}
                <p class="list-item-desc">
                  {{ post.description | truncate: 160 }}
                </p>
              {% elsif post.excerpt %}
                <p class="list-item-desc">
                  {{ post.excerpt | strip_html | truncate: 160 }}
                </p>
              {% endif %}
              
              <div class="list-meta">
                <span class="list-category">{{ current_category | capitalize }}</span>
                {% if post.date %}
                  <span class="list-date">
                    <i class="fas fa-calendar-alt"></i>
                    {{ post.date | date: "%B %d, %Y" }}
                  </span>
                {% endif %}
              </div>
            </a>
          </article>
        {% endunless %}
      {% endfor %}
    {% else %}
      <article class="list-item empty">
        <h2>No content available</h2>
        <p>Category: {{ current_category }}</p>
        <p>Looking for posts in: posts/{{ current_category }}/</p>
        <p>Total posts in site: {{ site.posts.size }}</p>
        <p>Debug - Sample post paths:</p>
        {% for post in site.posts limit:5 %}
          <p>- {{ post.path }}</p>
        {% endfor %}
        <p>New writeups will be added soon.</p>
      </article>
    {% endif %}
  </div>
</section>
