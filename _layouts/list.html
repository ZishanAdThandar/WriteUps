<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>{{ page.title }} | {{ site.title }}</title>
  {% seo %}
  <link rel="stylesheet" href="/assets/css/style.css">
</head>
<body>

{% include header.html %}

<div class="container">

  <main>
    <header class="page-header">
      <h1 class="page-title">{{ page.title }}</h1>
      {% if page.description %}
        <p class="page-description">{{ page.description }}</p>
      {% endif %}
    </header>

    {% assign current_category = page.dir | split: '/' | last %}
    {% assign category_posts = "" | split: "," %}

    <!-- Get all pages in the current category directory -->
    {% for p in site.pages %}
      {% assign page_dir = p.dir | split: '/' %}
      {% assign category = page_dir[1] %}
      {% assign is_post = p.name != 'index.md' and p.path contains '.md' %}
      
      {% if category == current_category and is_post %}
        {% assign category_posts = category_posts | push: p %}
      {% endif %}
    {% endfor %}

    {% assign category_posts = category_posts | sort: "date" | reverse %}

    {% if category_posts.size > 0 %}
      <div class="posts-grid">
        {% for post in category_posts %}
          <article class="post-card">
            <div class="post-card-content">
              <h2 class="post-card-title">
                <a href="{{ post.url }}">{{ post.title }}</a>
              </h2>

              {% if post.description %}
                <p class="post-card-excerpt">
                  {{ post.description | truncate: 180 }}
                </p>
              {% endif %}

              <div class="post-card-meta">
                {% if post.date %}
                  <span>{{ post.date | date: "%B %d, %Y" }}</span>
                {% endif %}
                <span class="post-card-category">
                  {{ current_category | capitalize }}
                </span>
              </div>
            </div>
          </article>
        {% endfor %}
      </div>
    {% else %}
      <div class="no-posts">
        <h2>No posts found</h2>
        <p>Nothing published in this category yet.</p>
      </div>
    {% endif %}
  </main>

  {% include sidebar.html %}

</div>

{% include footer.html %}

</body>
</html>
